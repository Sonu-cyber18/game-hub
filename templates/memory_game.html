{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Emoji Memory Match - Level Up!</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #4a6fa5;
      --secondary: #166088;
      --accent: #4fc3f7;
      --background: #f8f9fa;
      --card-bg: #ffffff;
      --text: #333333;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: var(--background);
      color: var(--text);
      text-align: center;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .main-container {
        padding: 20px;
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        align-items: center;
        flex-grow: 1;
    }

    /* Navbar Styles */
    .navbar {
        background: linear-gradient(90deg, var(--primary), var(--secondary));
        padding: 1rem 2rem;
        box-shadow: var(--shadow);
        width: 100%;
        position: sticky;
        top: 0;
        z-index: 1000;
    }

    .navbar-container {
        max-width: 800px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        padding: 0 20px;
    }

    .logo {
        color: var(--accent);
        font-size: 1.5rem;
        font-weight: 700;
        text-decoration: none;
    }

    .nav-links {
        display: flex;
        gap: 1.5rem;
    }

    .nav-links a {
        color: white;
        text-decoration: none;
        font-weight: 500;
        transition: var(--transition);
    }

    .nav-links a:hover {
        color: var(--accent);
    }

    header {
      margin-bottom: 2rem;
      width: 100%;
    }

    h1 {
      color: var(--secondary);
      font-size: 2.2rem;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .stats {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-bottom: 1.5rem;
      width: 100%;
    }

    .stat-box {
      background: var(--card-bg);
      padding: 0.8rem 1.5rem;
      border-radius: 10px;
      box-shadow: var(--shadow);
      font-weight: 600;
      min-width: 120px;
    }

    #game-board {
      display: grid;
      gap: 15px;
      max-width: 800px;
      width: 100%;
      margin: 0 auto;
    }

    .card {
      aspect-ratio: 1/1;
      background: var(--primary);
      color: transparent;
      border-radius: 12px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      font-size: 2rem;
      transition: var(--transition);
      box-shadow: var(--shadow);
      position: relative;
      transform-style: preserve-3d;
      transform: rotateY(180deg);
    }

    .card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: var(--primary);
      border-radius: 12px;
      backface-visibility: hidden;
      transform: rotateY(0deg);
    }

    .card.flipped {
      background: var(--card-bg);
      color: var(--text);
      transform: rotateY(0deg);
    }

    .card.flipped::before {
      transform: rotateY(180deg);
    }

    .card.matched {
      background: var(--accent);
      cursor: default;
    }

    #restart {
      margin-top: 2rem;
      padding: 0.8rem 2rem;
      background: var(--secondary);
      border: none;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      border-radius: 50px;
      transition: var(--transition);
      box-shadow: var(--shadow);
    }

    #restart:hover {
      background: var(--primary);
      transform: translateY(-2px);
    }

    #level-up {
      margin-top: 1rem;
      padding: 0.8rem 2rem;
      background: #4CAF50;
      border: none;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      border-radius: 50px;
      transition: var(--transition);
      box-shadow: var(--shadow);
      display: none;
    }

    #level-up:hover {
      background: #45a049;
      transform: translateY(-2px);
    }

    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      background-color: #f00;
      border-radius: 50%;
      animation: fall 5s linear infinite;
      z-index: 1000;
    }

    @keyframes fall {
      0% {
        transform: translateY(-100vh) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }

    .level-indicator {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: var(--secondary);
      color: white;
      padding: 1rem;
      font-size: 1.5rem;
      font-weight: bold;
      transform: translateY(-100%);
      transition: transform 0.5s ease;
      z-index: 1001;
    }

    .level-indicator.show {
      transform: translateY(0);
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 1.8rem;
      }
      
      .stats {
        flex-direction: column;
        align-items: center;
        gap: 1rem;
      }
      
      .card {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="navbar-container">
        <a href="{% url 'home' %}" class="logo">GameHub</a>
        <div class="nav-links">
            <a href="{% url 'dashboard' %}">Dashboard</a>
            <a href="{% url 'profile' %}">Profile</a>
            <a href="{% url 'logout' %}">Logout</a>
        </div>
    </div>
  </nav>
  <div class="main-container">
    <div class="level-indicator" id="level-indicator">Level 1 Complete!</div>
    
    <header>
      <h1>ðŸ§  Emoji Memory Match</h1>
      <div class="stats">
        <div class="stat-box" id="moves">Moves: 0</div>
        <div class="stat-box" id="pairs">Pairs: 0/4</div>
        <div class="stat-box" id="level">Level: 1</div>
      </div>
    </header>
    
    <div id="game-board"></div>
    <button id="restart">Restart Level</button>
    <button id="level-up">Next Level âž”</button>
  </div>

  <script>
    const emojiSets = [
      ['ðŸ¶', 'ðŸ±', 'ðŸ¦Š', 'ðŸ¸'],        // Level 1 - 4 pairs (2x4 grid)
      ['ðŸ¶', 'ðŸ±', 'ðŸ¦Š', 'ðŸ¸', 'ðŸµ'],   // Level 2 - 5 pairs (5x2 grid)
      ['ðŸ¶', 'ðŸ±', 'ðŸ¦Š', 'ðŸ¸', 'ðŸµ', 'ðŸ¼'], // Level 3 - 6 pairs (3x4 grid)
      ['ðŸ¶', 'ðŸ±', 'ðŸ¦Š', 'ðŸ¸', 'ðŸµ', 'ðŸ¼', 'ðŸ·', 'ðŸ¦„'] // Level 4 - 8 pairs (4x4 grid)
    ];
    
    const levelConfigs = [
      { cols: 4, pairs: 4 },  // Level 1
      { cols: 5, pairs: 5 },  // Level 2
      { cols: 4, pairs: 6 },  // Level 3
      { cols: 4, pairs: 8 }   // Level 4
    ];

    let currentLevel = 0;
    let board = [];
    let firstCard = null;
    let secondCard = null;
    let lockBoard = false;
    let moves = 0;
    let matchedPairs = 0;

    const boardEl = document.getElementById('game-board');
    const movesEl = document.getElementById('moves');
    const pairsEl = document.getElementById('pairs');
    const levelEl = document.getElementById('level');
    const restartBtn = document.getElementById('restart');
    const levelUpBtn = document.getElementById('level-up');
    const levelIndicator = document.getElementById('level-indicator');

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function createConfetti() {
      const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4CAF50', '#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107', '#FF9800', '#FF5722'];
      
      for (let i = 0; i < 100; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = `${Math.random() * 100}vw`;
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.width = `${Math.random() * 10 + 5}px`;
        confetti.style.height = confetti.style.width;
        confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
        confetti.style.animationDelay = `${Math.random() * 2}s`;
        document.body.appendChild(confetti);
        
        setTimeout(() => {
          confetti.remove();
        }, 5000);
      }
    }

    function showLevelComplete() {
      levelIndicator.textContent = `Level ${currentLevel + 1} Complete!`;
      levelIndicator.classList.add('show');
      
      setTimeout(() => {
        levelIndicator.classList.remove('show');
      }, 2000);
    }

    function setupBoard() {
      boardEl.innerHTML = '';
      
      const config = levelConfigs[currentLevel];
      const emojis = emojiSets[currentLevel];
      
      boardEl.style.gridTemplateColumns = `repeat(${config.cols}, minmax(70px, 1fr))`;
      
      board = shuffle([...emojis, ...emojis]);
      moves = 0;
      matchedPairs = 0;
      movesEl.textContent = "Moves: 0";
      pairsEl.textContent = `Pairs: 0/${config.pairs}`;
      levelEl.textContent = `Level: ${currentLevel + 1}`;
      firstCard = secondCard = null;
      lockBoard = false;
      levelUpBtn.style.display = 'none';

      board.forEach((emoji, index) => {
        const card = document.createElement('div');
        card.classList.add('card');
        card.dataset.emoji = emoji;
        card.dataset.index = index;
        card.textContent = emoji;
        card.addEventListener('click', flipCard);
        boardEl.appendChild(card);
      });
    }

    function flipCard() {
      if (lockBoard || this === firstCard || this.classList.contains('matched')) return;

      this.classList.add('flipped');

      if (!firstCard) {
        firstCard = this;
        return;
      }

      secondCard = this;
      moves++;
      movesEl.textContent = `Moves: ${moves}`;
      checkForMatch();
    }

    function checkForMatch() {
      const isMatch = firstCard.dataset.emoji === secondCard.dataset.emoji;
      const config = levelConfigs[currentLevel];
      
      if (isMatch) {
        disableCards();
        matchedPairs++;
        pairsEl.textContent = `Pairs: ${matchedPairs}/${config.pairs}`;
        
        if (matchedPairs === config.pairs) {
          showLevelComplete();
          createConfetti();
          
          if (currentLevel < emojiSets.length - 1) {
            setTimeout(() => {
              levelUpBtn.style.display = 'block';
            }, 1000);
          } else {
            setTimeout(() => {
              alert(`Congratulations! You've completed all levels with ${moves} total moves!`);
            }, 500);
          }
        }
      } else {
        unflipCards();
      }
    }

    function disableCards() {
      firstCard.classList.add('matched');
      secondCard.classList.add('matched');
      firstCard = secondCard = null;
    }

    function unflipCards() {
      lockBoard = true;
      
      setTimeout(() => {
        firstCard.classList.remove('flipped');
        secondCard.classList.remove('flipped');
        firstCard = secondCard = null;
        lockBoard = false;
      }, 1000);
    }

    function nextLevel() {
      currentLevel++;
      setupBoard();
    }

    restartBtn.addEventListener('click', setupBoard);
    levelUpBtn.addEventListener('click', nextLevel);

    // Initialize game
    setupBoard();
  </script>
</body>
</html>